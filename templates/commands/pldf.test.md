---
description: Команда тестирования студентов - генерация тестов на основе артефактов текущего и всех предыдущих этапов, интерактивный опрос и сохранение оценок
scripts:
  sh:
  ps:
---

## Пользовательский ввод

```text
$ARGUMENTS
```

Ты **ОБЯЗАН** учитывать пользовательский ввод перед продолжением (если он не пустой).

## Правила диалога со студентом

- **Задавай вопросы строго по одному**: в каждом твоем сообщении должен быть **ровно 1 вопрос**, который требует ответа студента.
- **Не выдавай список вопросов заранее** (никаких длинных анкет/чек-листов вопросов за раз).
- Если нужен выбор, задай **один вопрос** и предложи **не больше 3–5 вариантов** (или попроси свободный ответ).
- **Дожидайся ответа** и только затем задавай следующий вопрос.
- Если ответ неполный — задай **один уточняющий вопрос**, а не несколько сразу.

## Правила безопасности тестирования

**КРИТИЧНО - эти правила обязательны для всех этапов:**

- **НЕ показывай студенту** структуру JSON с полем `correctAnswer` до завершения всего теста
- **НЕ показывай** правильные ответы до завершения всего теста
- **НЕ давай подсказок** во время ответа на вопрос
- **НЕ давай обратную связь** о правильности ответа сразу после ответа студента (никаких "Правильно!", "Неправильно!", "Хороший ответ!")
- **НЕ показывай метки** (✓, ✗) рядом с вариантами ответов до завершения теста
- После каждого ответа благодари нейтрально (например, "Спасибо за ответ!") и переходи к следующему вопросу
- **ВАРЬИРУЙ позицию правильных ответов** - не делай правильный ответ всегда первым или последним вариантом
- **СОЗДАВАЙ правдоподобные дистракторы** - неправильные варианты должны выглядеть разумно, избегай очевидно неправильных вариантов

Правильные ответы и объяснения показывай **ТОЛЬКО в финальном отчете** после завершения теста.

## Описание

Эта команда **PLDF** позволяет студенту в любой момент пройти тестирование на основе артефактов текущего и всех предыдущих этапов проекта. Команда генерирует тесты трех типов, проводит интерактивный опрос и сохраняет детальную оценку с историей попыток.

## Предварительные условия

- Должен существовать хотя бы один артефакт проекта в `.pldf/`
- Если артефактов нет, предложи начать с этапа concept (`/pldf.concept`)

## Цель команды

Провести тестирование студента для оценки понимания материала:
- Проверить знание ключевых концепций из всех пройденных этапов
- Выявить слабые места в понимании
- Отследить прогресс по сравнению с предыдущими попытками
- Предоставить конструктивные рекомендации для улучшения

## Рабочий процесс

### 1. Определение текущего этапа

Определи текущий этап проекта на основе существующих артефактов в `.pldf/`:

- **concept**: если существует `.pldf/concept.md`
- **platforms**: если существует `.pldf/platforms.md`
- **design**: если существует `.pldf/ui-design.md` или `.pldf/ui-prototype/`
- **tech**: если существует `.pldf/tech-stack.md`
- **architecture**: если существует `.pldf/architecture.md`
- **plan**: если существует `.pldf/implementation-plan.md`
- **implement**: если существует код проекта и `.pldf/memory/progress.json` с шагами
- **review**: если существует `.pldf/review.md`

Текущий этап = последний созданный артефакт. Если артефактов нет - сообщи студенту и предложи начать с `/pldf.concept`.

### 2. Загрузка всех существующих артефактов

Загрузи все артефакты из `.pldf/`:
- **Этапы**: `concept.md`, `platforms.md`, `ui-design.md`, `tech-stack.md`, `tech-rationale.md`, `architecture.md`, `data-model.md`, `implementation-plan.md`, `review.md`, `project-context.md`
- **Контекст**: папки `contracts/`, `ui-prototype/`, `memory/progress.json`

### 3. Загрузка истории предыдущих попыток

**Если `.pldf/assessments.json` существует:**
- Загрузи и проанализируй: список ID вопросов, оценки по этапам/темам, прогресс, количество попыток, средний балл

**Если не существует:**
- Это первая попытка, создай структуру из шаблона `assessment-template.json`

### 4. Генерация тестов на основе артефактов

Сгенерируй тесты (15-20 вопросов) на основе всех загруженных артефактов. **Помни о правилах безопасности** (см. раздел выше).

**Типы вопросов:**
- **Single choice** (выбор одного варианта) - 2-4 вопроса
- **Multiple choice** (выбор нескольких вариантов) - 1-3 вопроса
- **Free text** (свободный ответ) - 2-3 вопроса

**Распределение вопросов по этапам:**

| Этап | Примеры тем | Вопросов |
|------|-------------|----------|
| concept | целевая_аудитория, проблема, функции_mvp, приоритизация | 1-2 |
| platforms | выбор_платформ, обоснование_платформ, кроссплатформенность | 1-2 |
| design | пользовательские_потоки, данные_экранов, ui_паттерны, навигация | 1-2 |
| tech | выбор_технологий, обоснование_выбора, альтернативы, компромиссы | 1-2 |
| architecture | структура_проекта, модель_данных, api_контракты, архитектурные_паттерны | 1-2 |
| plan | разбивка_на_шаги, зависимости, валидация, планирование | 1-2 |
| implement | реализация, связи_шагов, валидация_кода, тестирование | 1-2 |
| review | анализ, улучшения, рефлексия, best_practices | 1-2 |

- Минимум 1-2 вопроса на каждый существующий этап
- Больше вопросов на текущий этап (2-3)
- Вопросы должны проверять понимание связей между этапами

**Учет предыдущих попыток:**

- **Первая попытка**: базовые вопросы, равномерное распределение, стандартная сложность
- **Повторные попытки**: избегай повторения ID вопросов, больше вопросов по слабым темам (<60%), усложняй сильные темы (>80%), задавай вопросы о межэтапных связях

**Формат вопроса:**
```json
{
  "id": "q-XXX-YYY",
  "type": "single_choice|multiple_choice|free_text",
  "text": "Текст вопроса",
  "stage": "concept|platforms|design|tech|architecture|plan|implement|review",
  "topic": "название_темы",
  "options": ["вариант 1", "вариант 2", ...],
  "correctAnswer": "...",
  "maxScore": 1.0
}
```

**Правила формулировки вариантов:**

**Single choice:**
- 3-4 варианта, правильный ответ основан на артефактах
- Дистракторы правдоподобны: частично правильная информация, противоположное утверждение, смешение концепций
- **ВАРЬИРУЙ позицию правильного ответа** (A, B, C, D)

**Multiple choice:**
- 4-6 вариантов, 2-3 правильных
- Укажи в вопросе: "Выберите ВСЕ правильные варианты"
- **ВАРЬИРУЙ позицию и комбинации** правильных ответов

**Free text:**
- Открытые вопросы, проверяющие понимание (не запоминание)
- Минимум 2-3 предложения в ответе
- Определи заранее ключевые концепции для оценки

**Примеры вопросов:**

**Single choice - хороший пример:**
```
Какая основная проблема целевой аудитории описана в концепции?
A) Отсутствие мотивации для занятий спортом
B) Сложность отслеживания прогресса в тренировках ← правильный
C) Высокая стоимость персональных тренеров
D) Недостаток времени для походов в спортзал
```

**Single choice - плохой пример (НЕ делай так):**
```
Какая проблема описана?
A) Сложность отслеживания ← слишком очевидно
B) Банановая проблема ← явная ерунда
C) Не знаю ← не является дистрактором
```

**Multiple choice - хороший пример:**
```
Какие платформы были выбраны для MVP? (Выберите ВСЕ правильные варианты)
A) iOS ← правильный
B) Android ← правильный
C) Web приложение ← правильный
D) Desktop приложение
E) Smart TV
```

**Free text - хороший пример:**
```
Объясните, почему для backend была выбрана чистая архитектура? 
Какие преимущества это дает? (минимум 2-3 предложения)

Ожидаемые концепции: независимость от фреймворков, тестируемость, 
разделение на слои, легкость замены технологий
```

### 5. Интерактивный опрос студента

1. **Приветствие**: объясни, что будет тестирование, укажи количество вопросов

2. **Задавай вопросы по очереди**: 
   - Покажи номер вопроса и этап (например, "Вопрос 1 из 8 (concept):")
   - Для single choice: варианты с буквами (A, B, C, D)
   - Для multiple choice: добавь "Выберите ВСЕ правильные варианты (например: A, C, D)"
   - Для free text: объясни, что нужен развернутый ответ (минимум 2-3 предложения)
   - **Помни о правилах безопасности**: не показывай JSON, correctAnswer, метки, не давай обратную связь
   - После ответа благодари нейтрально и переходи к следующему вопросу

3. **После всех вопросов**: поблагодари и сообщи, что сейчас будет оценка

### 6. Оценка ответов на основе артефактов

**ВАЖНО:** Оценка проводится **ПОСЛЕ** всех вопросов. **Помни о правилах безопасности**.

**Single choice:**
- Сравни с `correctAnswer`: правильный → `score = maxScore`, неправильный → `score = 0`

**Multiple choice:**
- Формула: `score = ((правильно_выбранных - неправильно_выбранных) / общее_количество_правильных) * maxScore`
- Минимум `score = 0`

**Free text:**
- Семантический анализ на основе артефактов
- Оценки: 0.9-1.0 (отлично), 0.7-0.89 (хорошо), 0.5-0.69 (удовлетворительно), 0-0.49 (неудовлетворительно)

**Вычисление оценок:**
- Для каждого этапа: средняя оценка по вопросам этапа
- Для каждой темы: средняя оценка по вопросам темы
- Общий балл: `overallScore = (сумма всех score / сумма всех maxScore) * 100`

### 7. Генерация детального отчета

**Структура отчета:**

1. **Общий балл**: процент и оценка (90-100%: Отлично, 75-89%: Хорошо, 60-74%: Удовлетворительно, <60%: Требуется повторение)
2. **Разбивка по этапам**: средняя оценка, количество вопросов, какие этапы усвоены/требуют повторения
3. **Разбивка по темам**: средняя оценка, количество вопросов, темы с высокими/низкими оценками
4. **Конкретные рекомендации**: что изучить, какие артефакты пересмотреть для каждого слабого этапа/темы
5. **Сравнение с предыдущими попытками** (если есть): прогресс по темам, улучшение общего балла
6. **Рекомендации для следующего тестирования**: какие темы изучить глубже

### 8. Сохранение результатов в файл оценок

Сохрани в `.pldf/assessments.json`:

**Создай новую запись assessment:**
```json
{
  "id": "assessment-XXX",
  "date": "YYYY-MM-DD",
  "currentStage": "этап",
  "questions": [...],
  "scores": {
    "byStage": {"concept": 85.5, ...},
    "byTopic": {"целевая_аудитория": 90.0, ...}
  },
  "overallScore": 82.5,
  "detailedReport": {...}
}
```

**Обнови статистику:**
- `statistics.totalAttempts` - увеличить на 1
- `statistics.averageScore` - пересчитать
- `statistics.byStage` и `statistics.byTopic` - обновить средние
- `statistics.progress` - проанализировать: `improvingTopics`, `stagnantTopics`, `decliningTopics`

### 9. Вывод результатов студенту

**ВАЖНО:** Только СЕЙЧАС можно показывать правильные ответы.

1. **Краткое резюме**: общий балл и количество правильных ответов

2. **Детальный отчет по вопросам**:
   ```
   Вопрос 1 (concept): Какая основная проблема...?
   Твой ответ: B
   Правильный ответ: B ✓
   Оценка: 1.0/1.0
   Объяснение: Правильно! В `.pldf/concept.md` описана именно эта проблема.
   
   Вопрос 2 (platforms): Какие платформы...?
   Твой ответ: A, B
   Правильный ответ: A, B, C
   Оценка: 0.67/1.0
   Объяснение: Пропущен вариант C, который указан в `.pldf/platforms.md`.
   ```

3. **Разбивка по этапам и темам**: средние оценки, какие усвоены/требуют повторения

4. **Сравнение с предыдущими попытками** (если есть): прогресс, улучшение балла

5. **Конкретные рекомендации**: что изучить, какие артефакты пересмотреть

6. **Путь к файлу**: укажи `.pldf/assessments.json` для просмотра полной истории

## Выходные артефакты

- `.pldf/assessments.json` - файл с историей всех попыток тестирования и статистикой

## Пример диалога

```
AI: Привет! Проведем тестирование по твоему проекту. Будет 8 вопросов по этапам: concept, platforms, design. Готов?

Студент: Да

AI: Вопрос 1 из 8 (concept):
Какая основная проблема целевой аудитории описана в концепции?
A) Отсутствие мотивации
B) Сложность отслеживания прогресса
C) Высокая стоимость тренеров
D) Недостаток времени

Студент: B

AI: Спасибо за ответ!

Вопрос 2 из 8 (platforms): ...

[После всех вопросов]

AI: Спасибо за прохождение! Сейчас оценю твои ответы.

[Результаты]

AI: **Общий балл:** 85% (Хорошо)

**Разбивка:**
- concept: 90%
- platforms: 100%
- design: 75%

**Детальный анализ:**
[показать правильные ответы и объяснения]
```

**Ключевые правила:**

✅ **ДЕЛАЙ:**
- Показывай только текст вопроса и варианты
- Нейтрально благодари за ответы
- Оценивай все после завершения теста
- Давай детальный разбор в конце

❌ **НЕ ДЕЛАЙ:**
- Не показывай JSON или correctAnswer до конца
- Не давай обратную связь во время теста
- Не показывай метки (✓, ✗) до конца

## Примеры использования

```
/pldf.test
```

Команда автоматически определит текущий этап, загрузит все артефакты и проведет тестирование.

## Подсказки и помощь

**Когда использовать:**
- После завершения любого этапа для проверки понимания
- Перед переходом к следующему этапу для закрепления знаний
- В любой момент для оценки текущего уровня понимания

**Если студент получил низкий балл (<60%):**
- Предложи пересмотреть соответствующие артефакты
- Укажи конкретные разделы для изучения
- Предложи пройти тест еще раз после изучения
- Дай конструктивные рекомендации с примерами

**Если студент получил высокий балл (>80%):**
- Поздравь с результатом
- Предложи более сложные вопросы в следующий раз
- Укажи на темы для углубленного изучения
