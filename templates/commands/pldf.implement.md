---
description: Этап 5: Пошаговая реализация проекта с автоматической валидацией и отслеживанием прогресса
scripts:
  sh:
  ps:
---

## Пользовательский ввод

```text
$ARGUMENTS
```

Ты **ОБЯЗАН** учитывать пользовательский ввод перед продолжением (если он не пустой).

## Правила диалога со студентом (обязательно)

- **Задавай вопросы строго по одному**: в каждом твоем сообщении должен быть **ровно 1 вопрос**, который требует ответа студента.
- **Не выдавай список вопросов заранее** (никаких длинных анкет/чек-листов вопросов за раз).
- Если нужен выбор, задай **один вопрос** и предложи **не больше 3–5 вариантов** (или попроси свободный ответ).
- **Дожидайся ответа** и только затем задавай следующий вопрос.
- Если ответ неполный — задай **один уточняющий вопрос**, а не несколько сразу.

## Описание

Этот этап **PLDF (Progressive Learning Development Framework)** выполняет пошаговую реализацию проекта согласно плану. Каждый шаг:
- Выполняется последовательно (с учетом зависимостей)
- Валидируется через тесты
- Отмечается как завершенный в `.pldf/memory/progress.json`
- Может быть возобновлен с любого шага

## Предварительные условия

- Должен существовать `.pldf/implementation-plan.md`
- Должна существовать директория `.pldf/steps/` с описаниями шагов
- Должен существовать `.pldf/memory/progress.json`
- Если файлы отсутствуют, предложи выполнить `/pldf.plan`

## Цель этапа

Реализовать проект пошагово, обеспечивая:
- Выполнение каждого шага согласно плану
- Валидацию через автоматические и ручные тесты
- Отслеживание прогресса
- Возможность возобновления с любого шага

## Рабочий процесс

0. **Загрузка контекста**:
   - Прочитай `.pldf/implementation-plan.md`
   - Прочитай `.pldf/memory/progress.json`
   - Прочитай все предыдущие артефакты (concept, design, tech, architecture)
   - **ОБЯЗАТЕЛЬНО**: Прочитай контексты планирования и реализации предыдущих шагов (если есть):
     - `.pldf/steps/step-[NN-1]-[prev-name]/planning-context.md` (контекст планирования предыдущего шага)
     - `.pldf/steps/step-[NN-1]-[prev-name]/implementation-context.md` (контекст реализации предыдущего шага)
     - Это поможет понять решения и проблемы предыдущих шагов
   - **ВАЖНО**: Используй HTML прототипы из `.pldf/ui-prototype/` как референс при реализации:
     - Открой соответствующий HTML файл для каждого экрана
     - Используй прототип как визуальный гайд для реализации
     - Убедись, что реализованный интерфейс соответствует прототипу

1. **Определение начального шага**:
   - Если `.pldf/memory/progress.json` указывает на `currentStep`, начните с него
   - Если `currentStep` равен `null`, начните с первого шага
   - Если пользователь указал конкретный шаг в `$ARGUMENTS`, используй его

2. **Проверка зависимостей**:
   - Для текущего шага проверь, что все зависимости завершены
   - Если зависимости не завершены, сообщи об ошибке и укажи, какие шаги нужно завершить сначала

2.5. **Формат именования шагов**:
   - Формат имени шага: `step-[NN]-[name]`, где:
     - `[NN]` — номер шага в формате двух цифр с ведущим нулем (01, 02, 03, ..., 10, 11, ...)
     - `[name]` — краткое название шага на английском языке (например: `setup`, `user-model`, `auth`)
   - Источники информации о шагах:
     - **Номер шага `[NN]`** берется из:
       - `.pldf/implementation-plan.md` (где шаги перечислены с номерами)
       - `.pldf/memory/progress.json` (поле `plannedSteps` содержит список шагов в формате `step-[NN]-[name]`)
       - Названий директорий в `.pldf/steps/` (если директории уже существуют)
     - **Название шага `[name]`** берется из:
       - `.pldf/implementation-plan.md` (название шага в плане)
       - Названия директории в `.pldf/steps/` (если директория уже существует)
       - `.pldf/memory/progress.json` (поле `plannedSteps` или `currentStep`)
   - Примеры: `step-01-setup`, `step-02-user-model`, `step-03-auth`, `step-10-api-integration`
   - **ВАЖНО**: При определении текущего шага используй точное имя из `.pldf/memory/progress.json` или `implementation-plan.md`, не придумывай формат самостоятельно

3. **Загрузка описания шага**:
   - Прочитай `.pldf/steps/step-[NN]-[name]/description.md`
   - Прочитай `.pldf/steps/step-[NN]-[name]/tasks.md`
   - Прочитай `.pldf/steps/step-[NN]-[name]/tests.md`
   - Прочитай `.pldf/steps/step-[NN]-[name]/validation.md`
   - **Примечание**: `[NN]` и `[name]` определяются из текущего шага (см. раздел 2.5)

4. **Выполнение шага**:
   - Выполни все задачи из `tasks.md`
   - Следуй описанию из `description.md`
   - Создавай/модифицируй файлы согласно задачам
   - Отмечай выполненные задачи в `tasks.md` (чекбоксы `[x]`)
   - **Примечание**: Файл `tasks.md` находится в `.pldf/steps/` и может быть частью репозитория. Если файл недоступен для редактирования, веди учет выполненных задач в отдельном файле или комментариях.

5. **Валидация шага**:
   
   **ВАЖНО**: Перед переходом к следующему шагу выполни полную валидацию текущего шага по следующему чек-листу:
   
   - [ ] **Все задачи из `tasks.md` выполнены**
     - Проверь файл `.pldf/steps/step-[NN]-[name]/tasks.md`
     - Все задачи должны быть отмечены как выполненные (чекбоксы `[x]`)
     - Все файлы, указанные в задачах, должны быть созданы или изменены
     - **Если не выполнено**: выполни недостающие задачи
   
   - [ ] **Автоматические тесты описаны**
     - Проверь файл `.pldf/steps/step-[NN]-[name]/tests.md` на наличие описания автоматических тестов
     - Если тесты указаны, проверь их наличие в кодовой базе проекта
     - Все тесты должны проходить успешно
     - **Если тесты нет, но они требуются в рамках текущего шага**: исправь проблемы и повтори проверки
     - **Если тестов нет и они не требуются на текущем шаге проекта**: пропусти этот пункт
   
   - [ ] **Ручные тесты описаны**
     - Проверь файл `.pldf/steps/step-[NN]-[name]/tests.md` на наличие ручных тестов/чек-листов
     - **Если ручных тестов нет, но они требуются на данном шаге**: исправь проблемы и повтори проверки
   
   - [ ] **Критерии завершения из `validation.md` выполнены**
     - Прочитай файл `.pldf/steps/step-[NN]-[name]/validation.md`
     - Проверь каждый критерий успешного завершения
     - Убедись, что реализация соответствует всем критериям
     - **Если критерии не выполнены**: доработай реализацию до соответствия критериям
   
   - [ ] **Реализация соответствует описанию шага**
     - Сравни реализованный код с описанием из `description.md`
     - Убедись, что реализация соответствует целям шага
     - **Если не соответствует**: пересмотри реализацию
   
   - [ ] **Код соответствует архитектуре проекта**
     - Проверь, что созданные файлы находятся в правильных директориях согласно архитектуре
     - Убедись, что код следует принципам из `.pldf/architecture.md`
     - **Если не соответствует**: приведи код в соответствие с архитектурой
   
   - [ ] **HTML прототипы учтены (если шаг касается UI)**
     - Если шаг связан с реализацией интерфейса (создание компонентов, страниц, форм, стилей), проверь соответствие HTML прототипам из `.pldf/ui-prototype/`
     - Реализованный интерфейс должен визуально соответствовать прототипу
     - **Если не соответствует**: приведи интерфейс в соответствие с прототипом
   
   **Если валидация не пройдена:**
   - Укажи конкретные пункты, которые не выполнены
   - Предложи конкретные исправления
   - **НЕ ПРОДОЛЖАЙ** к следующему шагу до прохождения валидации
   - **НЕ СОЗДАВАЙ** коммит в GIT до успешной валидации
   
   **Если валидация пройдена:**
   - Подтверди успешную валидацию шага
   - Переходи к обновлению прогресса (раздел 6)

6. **Обновление прогресса**:
   
   **ВАЖНО**: После успешной валидации шага обнови файл `.pldf/memory/progress.json` вручную:
   
   - Прочитай текущий файл `.pldf/memory/progress.json`
   - Выполни следующие обновления:
     
     a. **Добавь текущий шаг в `completedSteps`**:
        - Если шаг еще не присутствует в массиве `completedSteps`, добавь его
        - Формат: `"step-[NN]-[name]"` (например, `"step-01-setup"`)
     
     b. **Обнови `stepStatus` для текущего шага**:
        - Установи `stepStatus["step-[NN]-[name]"]` как объект с полями:
          - `status`: `"completed"`
          - `completedAt`: `"YYYY-MM-DD"` (дата завершения в формате ISO)
        - Пример: `stepStatus["step-01-setup"] = {"status": "completed", "completedAt": "2024-01-15"}`
     
     c. **Определи следующий шаг**:
        - Найди следующий незавершенный шаг из `plannedSteps` в `.pldf/memory/progress.json` (если поле существует)
        - Или найди следующий шаг из `implementation-plan.md`, который еще не завершен
        - Учитывай зависимости: следующий шаг должен иметь все зависимости в `completedSteps`
        - Если зависимости указаны в `planningMetadata.stepDependencies`, проверь их там
        - Если следующий шаг найден и все его зависимости завершены, установи `currentStep = "step-[NN]-[name]"`
        - Если все шаги завершены, установи `currentStep = null`
     
     d. **Сохрани обновленный `.pldf/memory/progress.json`**:
        - Убедись, что JSON валиден (правильный синтаксис, запятые, кавычки)
        - Сохрани файл
   
   **Пример обновления `.pldf/memory/progress.json`**:
   
   До обновления:
   ```json
   {
     "currentStep": "step-01-setup",
     "completedSteps": [],
     "plannedSteps": ["step-01-setup", "step-02-user-model", "step-03-auth"],
     "stepStatus": {},
     "planningMetadata": {
       "stepDependencies": {
         "step-02-user-model": ["step-01-setup"],
         "step-03-auth": ["step-02-user-model"]
       }
     }
   }
   ```
   
   После обновления (после завершения step-01-setup):
   ```json
   {
     "currentStep": "step-02-user-model",
     "completedSteps": ["step-01-setup"],
     "plannedSteps": ["step-01-setup", "step-02-user-model", "step-03-auth"],
     "stepStatus": {
       "step-01-setup": {
         "status": "completed",
         "completedAt": "2024-01-15"
       }
     },
     "planningMetadata": {
       "stepDependencies": {
         "step-02-user-model": ["step-01-setup"],
         "step-03-auth": ["step-02-user-model"]
       }
     }
   }
   ```
   
   **Примечание**: Поле `plannedSteps` и `planningMetadata` обычно не изменяются на этапе реализации, они создаются на этапе планирования. Обновляй только `currentStep`, `completedSteps` и `stepStatus`.
   
   **ВАЖНО**: 
   - Обновляй `.pldf/memory/progress.json` только после успешной валидации шага
   - Проверяй валидность JSON после каждого обновления
   - Не удаляй существующие данные из `.pldf/memory/progress.json`, только добавляй новые

6.5. **Создание контекста реализации**:
   
   После успешной валидации шага создай `.pldf/steps/step-[NN]-[name]/implementation-context.md`:
   - Используй шаблон `.pldf/templates/implementation-context-template.md`
   - Заполни все разделы шаблона:
     - **Краткое резюме реализации**: что было сделано на этом шаге
     - **Отклонения от плана**: если были (или укажи "Отклонений от плана не было")
     - **Ключевые решения при реализации**: решения, принятые во время реализации с альтернативами
     - **Проблемы и их решения**: проблемы, с которыми столкнулись (или укажи "Значительных проблем не возникло")
     - **Изменения в архитектуре**: если были (или укажи "Изменений в архитектуре не требовалось")
     - **Созданные/измененные файлы**: полный список с описаниями
     - **Результаты тестирования**: статус автоматических и ручных тестов, результат валидации
     - **Информация о коммите**: оставь пустым - будет заполнено после создания коммита
   - Сохрани в `.pldf/steps/step-[NN]-[name]/implementation-context.md`
   
   **Примечание**: Информация о коммите будет добавлена после создания коммита в разделе 7

7. **Коммит изменений в GIT**:
   - **ОБЯЗАТЕЛЬНО**: После успешной валидации шага и обновления `.pldf/memory/progress.json` создай коммит в GIT
   - Добавь все изменения, включая обновленный `.pldf/memory/progress.json`: `git add .`
   - Создай коммит с описанием шага:
     - Формат: `git commit -m "feat(step-NN): реализован шаг [название шага]"`
     - Пример: `git commit -m "feat(step-01): реализована настройка проекта"`
   - **Примечание**: Все изменения шага (код, тесты, документация, обновленный `.pldf/memory/progress.json`, `implementation-context.md`) должны быть включены в один коммит. Если тесты добавляются позже, создай отдельный коммит: `git commit -m "test(step-NN): добавлены тесты для шага [название]"`
   - **ВАЖНО**: Коммит создается только после успешной валидации шага
   - Если валидация не пройдена, НЕ создавай коммит до исправления ошибок
   
   - **После создания коммита**: Обнови `implementation-context.md`:
     - Получи хеш коммита: `git log -1 --format=%H`
     - Получи сообщение коммита: `git log -1 --format=%s`
     - Добавь эту информацию в раздел "Информация о коммите" в `.pldf/steps/step-[NN]-[name]/implementation-context.md`:
       - Хеш коммита
       - Сообщение коммита
       - Дата коммита
       - Краткое описание всех включенных изменений

8. **Обновление project-context.md**:
   - Обнови `.pldf/project-context.md`:
     - Установи текущий этап: "implement"
     - Обнови текущий шаг реализации
     - Обнови прогресс реализации ([X/Y шагов завершено])
     - Добавь/обнови информацию о завершенном шаге в раздел "Шаги реализации":
       - Номер и название шага
       - Ссылка на `implementation-context.md` в директории шага
       - Статус: "Завершен"
   - **ВАЖНО**: НЕ добавляй Decision Log напрямую в `project-context.md`, только навигацию и ссылки на контексты шагов

9. **Отчет о прогрессе**:
   - Выведи статус выполнения:
     - Текущий шаг завершен
     - Следующий шаг
     - Общий прогресс (X из Y шагов)

9. **Переход к следующему шагу**:
   - Если есть следующий шаг, спроси: "Перейти к следующему шагу? (да/нет/начать тестирование)"
   - Если "да", попроси учащегося открыть новый чат и снова запустить текущую команду
   - Если "нет" или "остановиться", сохрани прогресс и заверши работу
   - Если "начать тестирование", выполни автоматизированное тестирование текущего шага и опиши какие шаги необходимо выполнить учащемуся для ручной проверки работоспособности системы на данном шаге разработки

10. **Завершение**:
    - Когда все шаги завершены, выведи финальный отчет
    - Предложи финальную валидацию проекта
    - Поздравь с завершением и попроси подготовить антипригарное покрытие для кресла перед началом попыток развернуть систему на удаленном сервере, полностью протестировать ее работоспособность и т.д.

## Правила выполнения

- **СЛЕДУЙ** плану - не пропускай шаги
- **ВАЛИДИРУЙ** каждый шаг перед переходом к следующему (используй чек-лист из раздела 5)
- **ОБНОВЛЯЙ** `.pldf/memory/progress.json` вручную после каждого успешно завершенного шага (см. раздел 6)
- **КОММИТЬ** изменения в GIT после каждого успешно завершенного шага (только после валидации)
- **НЕ ПРОДОЛЖАЙ** если валидация не пройдена
- **НЕ КОММИТЬ** изменения до успешной валидации шага
- **НЕ ОБНОВЛЯЙ** `.pldf/memory/progress.json` до успешной валидации шага
- **ДОКУМЕНТИРУЙ** любые отклонения от плана

## Обработка ошибок

- Если шаг не может быть выполнен, остановись и сообщи о проблеме
- Предложи варианты решения
- Если нужно изменить план, задокументируйте изменения

## Подсказки и помощь

### Контекстные подсказки
При возникновении ошибок валидации система автоматически предложит подсказки для решения проблем в реализации.

### Подсказки по запросу
Используй команду `/hint` для получения наводящих вопросов:
- `/hint implement` - подсказка для этапа реализации
- `/hint implement testing` - подсказка по тестированию

### Типичные ошибки и решения

**Валидация шага пропущена:**
- Подсказка: Перед переходом к следующему шагу обязательно выполни валидацию текущего шага. Это гарантирует качество.
- Ресурсы: См. `.pldf/hints/resources.json` → `validation`

**Зависимости между шагами игнорируются:**
- Подсказка: Проверь план: выполняй шаги в правильном порядке, учитывая зависимости. Нельзя реализовать шаг, пока не выполнены его зависимости.
- Ресурсы: См. `.pldf/hints/resources.json` → `dependency_management`

**Тесты не пройдены:**
- Подсказка: Исправь ошибки в тестах перед продолжением. Тесты показывают, что шаг выполнен правильно.
- Ресурсы: См. `.pldf/hints/resources.json` → `testing`, `debugging`

## Выходные артефакты

- Реализованный код проекта
- Обновленный `.pldf/memory/progress.json`
- `.pldf/steps/step-[NN]-[name]/implementation-context.md` - контекст реализации каждого шага с решениями
- Документация изменений (если были отклонения от плана)
- История коммитов GIT с коммитом для каждого завершенного шага
- Обновленный `.pldf/project-context.md` (навигация и ссылки)

## Завершение

После завершения всех шагов проект готов! Предложи студенту:
- Финальную проверку всех функций
- Демонстрацию проекта
- Рефлексию над процессом разработки

